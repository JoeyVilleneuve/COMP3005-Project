import psycopg

# How to connect to an existing database
with psycopg.connect("dbname=test user=postgres") as conn:

    # How to open a cursor to perform database operations
    with conn.cursor() as cur:

        # How to execute a command
        cur.execute("""
            CREATE TABLE test (
                id serial PRIMARY KEY,
                num integer,
                data text)
            """)

        # How to pass data into a command
        cur.execute(
            "INSERT INTO test (num, data) VALUES (%s, %s)",
            (100, "abc'def"))

        # How to retrieve data from a query
        cur.execute("SELECT * FROM test")
        cur.fetchone() # Returns (1, 100, "abc'def"). Alternatively, can use "cur.fetchmany()", "cur.fetchall()" to return a list of several records
        
        # How to iterate the cursor
        for record in cur:
            print(record)

        # How to make the changes to the database persistent
        conn.commit()